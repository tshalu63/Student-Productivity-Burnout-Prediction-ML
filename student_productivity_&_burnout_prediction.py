# -*- coding: utf-8 -*-
"""Student Productivity & Burnout Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bPjVMICCdne8W1I6Lofx6pgaoJ_HxjKW
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

data = {
    "Study_Hours": [2,4,6,8,10,3,5,7,9,1,6,8,2,4,9],
    "Sleep_Hours": [5,6,7,8,6,4,7,6,5,3,8,7,4,6,5],
    "Screen_Time": [8,6,4,3,2,9,5,4,3,10,4,3,9,6,2],
    "Social_Media": [4,3,2,1,1,5,3,2,1,6,2,1,5,3,1],
    "Exercise_Hours": [0,1,1,2,2,0,1,1,2,0,2,2,0,1,2],
    "Productivity_Level": ["Burned","Average","Average","Productive","Productive",
                           "Burned","Average","Productive","Productive","Burned",
                           "Average","Productive","Burned","Average","Productive"]
}

df = pd.DataFrame(data)
df

from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()
df["Productivity_Level"] = le.fit_transform(df["Productivity_Level"])

df

X=df.drop("Productivity_Level",axis=1)
y=df["Productivity_Level"]

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(
    X,y,test_size=0.25, random_state=42
)

from sklearn.preprocessing import StandardScaler
scaler=StandardScaler()
X_train=scaler.fit_transform(X_train)
X_test=scaler.transform(X_test)

from sklearn.ensemble import RandomForestClassifier
model=RandomForestClassifier(n_estimators=100,random_state=42)
model.fit(X_train,y_train)

from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

y_pred = model.predict(X_test)

print("Accuracy:", accuracy_score(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))

plt.figure(figsize=(5,4))
sns.heatmap(confusion_matrix(y_test,y_pred),annot=True,cmap="Blues")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()

features=X.columns
importance=model.feature_importances_
plt.figure(figsize=(6,4))
sns.barplot(x=importance,y=features)
plt.title("Feature Importance")
plt.show()

new_student=np.array([[6,7,4,2,1]])
new_student_scaled=scaler.transform(new_student)
prediction=model.predict(new_student_scaled)
print("Predicted Productivity Level:",le.inverse_transform(prediction))